# Git 教程


## 一点点不同
如果你之前的 Git 协作是在同一个仓库，大家创建各自的分支，完成功能之后往 `dev` `release` `master` 3个分支去合并。它们分别对应测试、预发、正式环境。

那么我们现在的 Git 协作有点不同。

我们采用开源项目通用的 Git 协作方式，你需要把主仓库 fork 到你个人账号下，然后创建功能分支，完成需求之后往主仓库去提 PR。

具体流程可以参考下图：

<picture>
  <img src="../assets/git.jpg" alt="Image">
</picture>

所以我们需要用到 Git 的多 origin 管理功能：

```
git remote add [shortname] [url]
```
如下是我在本地仓库设置的多个源：

<picture>
  <img src="../assets/git-remote.png" alt="Image">
</picture>

这样的协作方式虽然麻烦一点，但是可以保证 commit 的简洁，也不会造成主仓库的分支灾难。

## 如何协作

单一源的协作非常方便，因为大家分支都在同一个地方，可以相互合并。多源的协作方式稍微麻烦点，假如`开发A`的某个功能依赖了`开发B`的某个分支，我们有2种情况可以参考：

### 开发B的分支可以单独提测

可以让`开发B`先将自己的功能分支提PR到主仓库，待合并之后，`开发A`再从主仓库切出最新分支进行开发。此时`开发A`在完成功能之后，可以独立的提PR到主仓库。

### 开发AB的功能需要合并一起才能提测

此时 `开发A` 就应该将 `开发B` 的源添加到自己的本地仓库，然后从`开发B` 的源切出功能分支，在此基础上做开发，待功能完成后，由`开发A` 向 `开发B` 发起 PR，最终由 `开发B` 向主仓库发起 PR。

## 如何 review 

如果是简单的功能我们可以直接通过 PR 地址进行review，对于复杂一些的功能，我们应该在本地对功能进行验证。此时可以使用 Git 命令将当前 PR 拉到本地进行验证。

```
git fetch origin pull/{id}/head:{branchname} 
```

- id: PR 的id
- branchname: 你本地创建的新分支的名称